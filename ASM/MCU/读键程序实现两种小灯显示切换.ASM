KEYWORK: JNB P1.0,K1
         JB P1.1,KEYWORK
K1:         ACALL DE1
         JNB P1.0,KEYFUN1
         JNB P1.1,KEYFUN2
         SJMP KEYWORK
KEYFUN1: MOV P3,#0FEH
S:LCALL DE
MOV A,P3
RL A
MOV P3,A
JNB P3.7,R
SJMP S
R:LCALL DE
RR A
MOV P3,A
JNB P3.0,OUT
SJMP R
OUT:MOV P3,#0FFH
SJMP KEYWORK
KEYFUN2: MOV R5,#7FH
     MOV R6,#0FEH
     MOV R7,#0
DIS1:ACALL DE
     MOV A,R5
     RL A
     MOV R5,A
     MOV A,R6
     RR A
     MOV R6,A
     ANL A,R5
     MOV P3,A
     INC R7
     CJNE R7,#9,DIS1
     MOV P3,#0FFH
     SJMP KEYWORK


DE0: MOV R2,#250 ;—” ±500us
     DJNZ R2,$
     RET
DE1: MOV R3,#20 ;—” ±10ms
DE10: ACALL DE0
      DJNZ R3,DE10
      RET
DE: MOV R4,#100 ;—” ±1s
DES: ACALL DE1
     DJNZ R4,DES
     RET
